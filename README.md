Контакты: grayhoax[at]grayhoax.ru
Телеграм: @grayhoax
Сбербанк: 855767899

Для работы требуется доступ с сервера Zabbix до адреса:
`ping api.telegram.org
telnet api.telegram.org 443`

УСТАНОВКА

1. Прописать Параметр - BOT_TOKEN. Его можно получить у бота @botfather (писать через телеграм). Команда для создания - /newbot. Далее - заполнить всё, что он просит. Из завершающего сообщения использовать код вида 2267788435192:ABEQ4qgWc15OXyTnDmаE29NdW8IFpGC_xqM (этот работать не будет).

2. В настройках пользователей нужно добавить способ оповещения. В поле "Отправлять на" требуется вставить идентификатор пользователя. Этот идентификатор можно получить у бота в телеграм @getidsbot написав ему любое сообщение. Идентификатор будет написан в строке "id:".

3. Каждый!!! пользователь должен написать созданному боту (в пункте 1) любое сообщение или нажать кнопку "Старт" в диалоге с ним. Иначе сообщения доходить не будут.

4. Создать действие (или отредактировать имеющееся). В разделе "Операции" в тексте МОЖНО использовать Эмодзи символы. Поскольку Zabbix sender не поддерживает кодировку utf8mb4 - решением проблемы стало вписывание кода символа (вида U+1A2B3) и его преобразование в коде web хука. Таблицу кодом можно посмотреть по ссылке https://apps.timwhitlock.info/emoji/tables/unicode. Код символа брать из столбца "Unicode".

ПРОВЕРКА
Для проверки работы следует использовать ссылку "Тест" напротив созданного способа оповещений. В открывшемся окне заменить значение параметра chat_id на свой идентификатор телеграм (как узнать описано в пункте 2 раздела "установка").
Если всё указано правильно - в телеграм поступит сообщение "{ALERT.MESSAGE}" или то, которое Вы вписали.

ОШИБКИ
В лог zabbix отправляется ошибка, возникшая при выполнении запроса.
При неверном ключе текст ошибки будет содержать код 401
--- TBD---
